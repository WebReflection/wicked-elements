<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="module">
  import {define, downgrade} from '../esm/index.js';
  function disconnected() {
    console.log('disconnected', this.__proto__);
    downgrade(this);
  }
  define('body > div', {
    observedAttributes: ['first'],
    attributeChanged() {
      console.log('first', arguments);
    },
    connected() {
      console.log('first', 'connected');
    },
    disconnected
  });
  define('html > body > div', {
    observedAttributes: ['first', 'second'],
    attributeChanged() {
      console.log('second', arguments);
    },
    disconnected
  });
  setTimeout(div => {
    div.setAttribute('first', 123);
    setTimeout(() => {
      div.setAttribute('second', 123);
      setTimeout(() => {
        document.body.textContent = '';
        setTimeout(() => {
          document.body.appendChild(div);
          setTimeout(() => {
            document.body.textContent = 'OK';
          }, 250);
        }, 250);
      }, 250);
    }, 250);
  }, 250, document.body.firstElementChild);
  </script>
</head>
<body><div></div></body>
</html>
